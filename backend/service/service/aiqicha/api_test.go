package aiqicha

import (
	"encoding/json"
	_ "fine/backend"
	"fine/backend/proxy/v2"
	"testing"
)

func TestTianYanCha_Suggest(t *testing.T) {
	c := NewClient("BDUSS=W9URW1-T0dJckN-eGJ1aFYxUHh3bFFGcDJ2NGZnUU1KMUZ0bFlKNnB1UkZ5bmRtSVFBQUFBJCQAAAAAAAAAAAEAAACyn8tdzOzJz7X0ysHX0wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEU9UGZFPVBmW; BDUSS_BFESS=W9URW1-T0dJckN-eGJ1aFYxUHh3bFFGcDJ2NGZnUU1KMUZ0bFlKNnB1UkZ5bmRtSVFBQUFBJCQAAAAAAAAAAAEAAACyn8tdzOzJz7X0ysHX0wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEU9UGZFPVBmW; BDPPN=d098240239e6e82fb32a3951ab20943d; log_guid=69a8b1c939d7a0fe7b7293e6c1dd2caf; BIDUPSID=18D5B7363E7DC928B3C2A252789500EB; PSTM=1725267792; BAIDUID=B060135E8FC7D1A9EB8DBBEA76129A04:SL=0:NR=10:FG=1; BAIDUID_BFESS=B060135E8FC7D1A9EB8DBBEA76129A04:SL=0:NR=10:FG=1; ZFY=KnUlfxVk4U3WiiCxRalxxFJKlzFgcLc9mNyEjbiXzc8:C; H_WISE_SIDS=60279_60839_60854_60875; H_PS_PSSID=60279_61027_60851_61098_61129_61128_61114_61140; MCITY=-340%3A; ZD_ENTRY=empty; H_WISE_SIDS_BFESS=60279_60839_60854_60875; login_type=passport; _t4z_qc8_=xlTM-TogKuTwBe1mHynzteJyHUcojPQvAQmd; in_source=; log_first_time=1736325842028; Hm_lvt_ad52b306e1ae4557f5d3534cce8f8bbf=1736325844; HMACCOUNT=B5545A24822A0F23; _j47_ka8_=57; entry=1001; _fb537_=xlTM-TogKuTwurxMNgHhbfRxfOmUIKqFvdIaQ78KLrpC-EMpvGVXyZcmd; ab173632320=25129a7aa20d8e1f8d46af903ff5ee501736326600673; Hm_lpvt_ad52b306e1ae4557f5d3534cce8f8bbf=1736326601; ab_sr=1.0.1_N2UyZDJiMDY5NjQ4ZDBlN2YzZjZhOTI3M2IxN2IyMTMyNzUyNmY2ZDQwODM5ZDIwM2IxNDc5YzIyMWRmZWY0YjZmMTVlMmIxZjFiOWMyMGNlY2YwYTI3NTFkOTcyN2FlODhlNjk5ZmRjM2E5NThmYTAxNTQzN2IwZGQwY2U3ZDU1NWQ1YWMwZDQ3NGU4ODQ5ODc4YTdmY2Y2ODc3NjA1Yg==; _s53_d91_=929243d1b3248c75ed0b7cfcc875b246bb39f9b8eaceb73b90ac64cd5963cc2a946e29f4044d8c219e08fa66dbc5665d1eefbe356f264524d20d72f87f1c9404c05bd78a47f841cd9596c7b355e02df033897a3639aca3e1c5caf499f74d9b3b0812e4180f1e0164c4d8af56a176e1d0a47f5abcfb03d1ec06510c441c2cbb511e5afc14d857c2a3a5a00c5b0a0ed2d455ccf52da4b039fb83b071084e1afe1de6d68e131f84cecb22b37ff70f371833d72a6cd10da68a681ff93b6924b67d5e00dd49b8f84fbcfe40a73719c12444e4; _y18_s21_=9829a201; log_last_time=1736326764534; RT=\"z=1&dm=baidu.com&si=73064e01-4274-4e96-b095-b8b16f541f60&ss=m5nnlbop&sl=37&tt=1b6t&bcn=https%3A%2F%2Ffclog.baidu.com%2Flog%2Fweirwood%3Ftype%3Dperf&ld=j6os\"")
	m := proxy.NewManager()
	_ = m.SetProxy("http://127.0.0.1:8081")
	c.UseProxyManager(m)
	list, err := c.Suggest("中国邮政")
	if err != nil {
		t.Error(err)
		return
	}
	marshal, e := json.Marshal(list)
	if e != nil {
		return
	}
	t.Log(string(marshal))
}

func TestAiqicha_GetStockChart(t *testing.T) {
	c := NewClient("BDUSS=W9URW1-T0dJckN-eGJ1aFYxUHh3bFFGcDJ2NGZnUU1KMUZ0bFlKNnB1UkZ5bmRtSVFBQUFBJCQAAAAAAAAAAAEAAACyn8tdzOzJz7X0ysHX0wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEU9UGZFPVBmW; BDUSS_BFESS=W9URW1-T0dJckN-eGJ1aFYxUHh3bFFGcDJ2NGZnUU1KMUZ0bFlKNnB1UkZ5bmRtSVFBQUFBJCQAAAAAAAAAAAEAAACyn8tdzOzJz7X0ysHX0wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEU9UGZFPVBmW; BDPPN=d098240239e6e82fb32a3951ab20943d; log_guid=69a8b1c939d7a0fe7b7293e6c1dd2caf; BIDUPSID=18D5B7363E7DC928B3C2A252789500EB; PSTM=1725267792; BAIDUID=B060135E8FC7D1A9EB8DBBEA76129A04:SL=0:NR=10:FG=1; BAIDUID_BFESS=B060135E8FC7D1A9EB8DBBEA76129A04:SL=0:NR=10:FG=1; ZFY=KnUlfxVk4U3WiiCxRalxxFJKlzFgcLc9mNyEjbiXzc8:C; H_WISE_SIDS=60279_60839_60854_60875; H_PS_PSSID=60279_61027_60851_61098_61129_61128_61114_61140; MCITY=-340%3A; ZD_ENTRY=empty; H_WISE_SIDS_BFESS=60279_60839_60854_60875; login_type=passport; _t4z_qc8_=xlTM-TogKuTwBe1mHynzteJyHUcojPQvAQmd; in_source=; log_first_time=1736325842028; Hm_lvt_ad52b306e1ae4557f5d3534cce8f8bbf=1736325844; HMACCOUNT=B5545A24822A0F23; _j47_ka8_=57; entry=1001; _fb537_=xlTM-TogKuTwurxMNgHhbfRxfOmUIKqFvdIaQ78KLrpC-EMpvGVXyZcmd; ab173632320=25129a7aa20d8e1f8d46af903ff5ee501736326600673; Hm_lpvt_ad52b306e1ae4557f5d3534cce8f8bbf=1736326601; ab_sr=1.0.1_N2UyZDJiMDY5NjQ4ZDBlN2YzZjZhOTI3M2IxN2IyMTMyNzUyNmY2ZDQwODM5ZDIwM2IxNDc5YzIyMWRmZWY0YjZmMTVlMmIxZjFiOWMyMGNlY2YwYTI3NTFkOTcyN2FlODhlNjk5ZmRjM2E5NThmYTAxNTQzN2IwZGQwY2U3ZDU1NWQ1YWMwZDQ3NGU4ODQ5ODc4YTdmY2Y2ODc3NjA1Yg==; _s53_d91_=929243d1b3248c75ed0b7cfcc875b246bb39f9b8eaceb73b90ac64cd5963cc2a946e29f4044d8c219e08fa66dbc5665d1eefbe356f264524d20d72f87f1c9404c05bd78a47f841cd9596c7b355e02df033897a3639aca3e1c5caf499f74d9b3b0812e4180f1e0164c4d8af56a176e1d0a47f5abcfb03d1ec06510c441c2cbb511e5afc14d857c2a3a5a00c5b0a0ed2d455ccf52da4b039fb83b071084e1afe1de6d68e131f84cecb22b37ff70f371833d72a6cd10da68a681ff93b6924b67d5e00dd49b8f84fbcfe40a73719c12444e4; _y18_s21_=9829a201; log_last_time=1736326764534; RT=\"z=1&dm=baidu.com&si=73064e01-4274-4e96-b095-b8b16f541f60&ss=m5nnlbop&sl=37&tt=1b6t&bcn=https%3A%2F%2Ffclog.baidu.com%2Flog%2Fweirwood%3Ftype%3Dperf&ld=j6os\"")
	m := proxy.NewManager()
	_ = m.SetProxy("http://127.0.0.1:8081")
	c.UseProxyManager(m)
	list, err := c.GetStockChart("28683666725524", "0")
	if err != nil {
		t.Error(err)
		return
	}
	marshal, e := json.Marshal(list)
	if e != nil {
		return
	}
	t.Log(string(marshal))
}
